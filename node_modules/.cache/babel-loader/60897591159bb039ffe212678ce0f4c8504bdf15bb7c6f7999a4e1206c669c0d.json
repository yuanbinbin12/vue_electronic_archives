{"ast":null,"code":"import { mapActions, mapMutations, mapState } from 'vuex';\nimport $ from 'jquery';\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      isHoverShow: false,\n      styleTopLeft: {\n        \"top\": \"0px\",\n        \"left\": \"0px\"\n      },\n      scrollX: 0,\n      scrollY: 0,\n      voucherCode: \"\"\n    };\n  },\n  name: 'BoxTree',\n  props: [\"boxKey\", \"positionArr\"],\n  computed: {\n    ...mapState(\"grounding\", [\"changeBoxList\", \"requestOutBox\", \"isGroupingCabinet\", \"downedBox\"]),\n    lightClass() {\n      if (this.changeBoxList.indexOf(this.boxKey[\"fguid\"]) !== -1) {\n        return \"boxing isChange\";\n      }\n      if (this.requestOutBox.indexOf(this.boxKey[\"fguid\"]) !== -1) {\n        return \"boxing outBox\";\n      }\n      if (this.boxKey[\"dataId\"] && this.boxKey[\"dataId\"][\"dataId\"] !== \"\" && this.boxKey[\"dataId\"] !== null && this.downedBox.indexOf(this.boxKey[\"fguid\"]) === -1) {\n        return \"boxing lighted\";\n      } else {\n        return \"boxing\";\n      }\n    },\n    getBoxingState() {\n      if (this.changeBoxList.indexOf(this.boxKey[\"fguid\"]) !== -1) {\n        return \"【待上架】\";\n      }\n      if (this.requestOutBox.indexOf(this.boxKey[\"fguid\"]) !== -1) {\n        return \"【待下架】\";\n      }\n      if (this.boxKey[\"dataId\"] && this.boxKey[\"dataId\"][\"dataId\"] !== \"\" && this.boxKey[\"dataId\"] !== null) {\n        return \"【已上架】\";\n      } else {\n        return \"【未上架】\";\n      }\n    }\n  },\n  methods: {\n    ...mapActions(\"grounding\", [\"setBoxid\"]),\n    ...mapMutations(\"grounding\", [\"setWarningMsg\", \"setOutBox\"]),\n    BoxingClick() {\n      if (this.$route.name === \"grouping\") {\n        if (this.boxKey[\"dataId\"] && this.boxKey[\"dataId\"] !== null && this.boxKey[\"dataId\"] !== \"\") {\n          // this.setWarningMsg({\"message\":\"该卡位已上架盒，不能进行再次上架！\",\"type\":\"error\"})\n          if (this.isGroupingCabinet === \"2\") {\n            this.setOutBox({\n              fileBagId: this.boxKey[\"fguid\"]\n            });\n          }\n        } else if (this.isGroupingCabinet === \"1\") {\n          this.setBoxid({\n            \"fileBagId\": this.boxKey[\"fguid\"],\n            \"fileBagName\": this.boxKey[\"slotMc\"] === null || this.boxKey[\"slotMc\"] === \"\" ? this.positionArr[0] + 1 + \"层-\" + (this.positionArr[1] + 1) + \"节-\" + (this.positionArr[2] + 1) + \"卡位\" : this.boxKey[\"slotMc\"],\n            \"repositoryId\": this.boxKey[\"repositoryId\"]\n          });\n          this.$forceUpdate();\n        }\n      }\n      debugger;\n      if (this.$route.name === \"GroupingQuery\" && this.boxKey[\"dataId\"] && this.boxKey[\"dataId\"] !== null && this.boxKey[\"dataId\"] !== \"\") {\n        window.parent.parent.openReactForm({\n          id: this.boxKey.dataId,\n          caption: '档案装盒',\n          serverID: 'serverID',\n          // 不需要可不传\n          config: {\n            displayType: 'OpenTab',\n            // 打开方式，默认为 OpenTab:应用新tab页; DrawerForm: 抽屉； BrowserTab：浏览器tab页； OpenWindow：弹窗\n            forms: 'EA_BOXING',\n            OBJ_GUID: this.boxKey.dataId,\n            OBJ_DJZT: \"2\"\n          }\n        });\n      }\n    },\n    boxMouseOver() {\n      this.isHoverShow = true;\n      if (this.boxKey[\"dataId\"] !== \"\" && this.boxKey[\"dataId\"] !== null && (this.voucherCode === \"\" || this.voucherCode === null)) {\n        axios.post(`/OSPApplication/cabinet/loadBoxCode/${this.boxKey[\"dataId\"]}`).then(res => {\n          if (res.data.code === \"0\") {\n            this.voucherCode = res.data.data;\n          }\n        }, error => {});\n      }\n      document.onmousemove = event => {\n        var offset = $(\".CabinetTree\").offset();\n        var width = $(\".hover-text\").width();\n        var x = event.clientX + this.scrollY - offset.left - width - 15;\n        var y = event.clientY + this.scrollX - offset.top + 10;\n        this.styleTopLeft[\"left\"] = x + \"px\";\n        this.styleTopLeft[\"top\"] = y + \"px\";\n      };\n    },\n    boxMouseOut() {\n      this.isHoverShow = false;\n      document.onmousemove = () => {\n        return null;\n      };\n    },\n    handleScroll() {\n      this.$nextTick(() => {\n        var top = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset;\n        var left = document.body.scrollLeft || document.documentElement.scrollLeft || window.pageXOffset;\n        this.scrollX = top;\n        this.scrollY = left;\n      });\n    }\n  },\n  mounted() {\n    //可以在这里面直接进行滚动条的获取\n    window.addEventListener('scroll', this.handleScroll, true);\n  },\n  beforeDestroy() {\n    window.removeEventListener('scroll', this.handleScroll, true);\n  }\n};","map":{"version":3,"names":["mapActions","mapMutations","mapState","$","axios","data","isHoverShow","styleTopLeft","scrollX","scrollY","voucherCode","name","props","computed","lightClass","changeBoxList","indexOf","boxKey","requestOutBox","downedBox","getBoxingState","methods","BoxingClick","$route","isGroupingCabinet","setOutBox","fileBagId","setBoxid","positionArr","$forceUpdate","window","parent","openReactForm","id","dataId","caption","serverID","config","displayType","forms","OBJ_GUID","OBJ_DJZT","boxMouseOver","post","then","res","code","error","document","onmousemove","event","offset","width","x","clientX","left","y","clientY","top","boxMouseOut","handleScroll","$nextTick","body","scrollTop","documentElement","pageYOffset","scrollLeft","pageXOffset","mounted","addEventListener","beforeDestroy","removeEventListener"],"sources":["src/components/BoxTree.vue"],"sourcesContent":["<template>\r\n    <div class=\"boxOut\">\r\n        <div :class=\"lightClass\" @click=\"BoxingClick\" @mouseover=\"boxMouseOver()\" @mouseout=\"boxMouseOut()\"></div>\r\n        <div class=\"hover-text\" id=\"hover-text\" v-show=\"isHoverShow\"    ref=\"hover-text\" :style=\"styleTopLeft\">\r\n            {{ boxKey[\"slotMc\"]===null || boxKey[\"slotMc\"]===\"\"?(positionArr[0]+1)+\"层-\"+(positionArr[1]+1)+\"节-\"+(positionArr[2]+1)+\"卡位\":boxKey[\"slotMc\"].split(\"柜-\")[1] }}\r\n            <div v-if=\"voucherCode!==''&& voucherCode!==null\" style=\"height: 12px;\">\r\n                {{ voucherCode }}\r\n            </div>\r\n            <br/>\r\n            {{ getBoxingState }}\r\n        </div>\r\n        <div></div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapActions, mapMutations, mapState} from 'vuex';\r\nimport $ from 'jquery';\r\nimport axios from 'axios';\r\nexport default {\r\n    data(){\r\n        return{\r\n            isHoverShow:false,\r\n            styleTopLeft:{\r\n                \"top\":\"0px\",\r\n                \"left\":\"0px\",\r\n            },\r\n            scrollX:0,\r\n            scrollY:0,\r\n            voucherCode:\"\"\r\n        }\r\n    },\r\n    name: 'BoxTree',\r\n    props:[\"boxKey\",\"positionArr\"],\r\n    computed:{\r\n        ...mapState(\"grounding\",[\"changeBoxList\",\"requestOutBox\",\"isGroupingCabinet\",\"downedBox\"]),\r\n        lightClass(){\r\n            if(this.changeBoxList.indexOf(this.boxKey[\"fguid\"])!==-1){\r\n                return \"boxing isChange\";\r\n            }\r\n            if(this.requestOutBox.indexOf(this.boxKey[\"fguid\"])!==-1){\r\n                return \"boxing outBox\";\r\n            }\r\n            if(this.boxKey[\"dataId\"]&&this.boxKey[\"dataId\"][\"dataId\"]!==\"\"&&this.boxKey[\"dataId\"]!==null&& this.downedBox.indexOf(this.boxKey[\"fguid\"])===-1){\r\n                return \"boxing lighted\";\r\n            }else{\r\n                return \"boxing\";\r\n            }\r\n        },\r\n        getBoxingState(){\r\n            if(this.changeBoxList.indexOf(this.boxKey[\"fguid\"])!==-1){\r\n                return \"【待上架】\";\r\n            }\r\n            if(this.requestOutBox.indexOf(this.boxKey[\"fguid\"])!==-1){\r\n                return \"【待下架】\";\r\n            }\r\n            if(this.boxKey[\"dataId\"]&&this.boxKey[\"dataId\"][\"dataId\"]!==\"\"&&this.boxKey[\"dataId\"]!==null){\r\n                return \"【已上架】\";\r\n            }\r\n            else {\r\n                return \"【未上架】\";\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        ...mapActions(\"grounding\",[\"setBoxid\"]),\r\n        ...mapMutations(\"grounding\",[\"setWarningMsg\",\"setOutBox\"]),\r\n        BoxingClick(){\r\n            if(this.$route.name===\"grouping\"){\r\n                if(this.boxKey[\"dataId\"]&&this.boxKey[\"dataId\"]!==null && this.boxKey[\"dataId\"]!==\"\"){\r\n                    // this.setWarningMsg({\"message\":\"该卡位已上架盒，不能进行再次上架！\",\"type\":\"error\"})\r\n                    if(this.isGroupingCabinet === \"2\"){\r\n                        this.setOutBox({fileBagId:this.boxKey[\"fguid\"]})\r\n                    }\r\n\r\n            } else if(this.isGroupingCabinet === \"1\"){\r\n                this.setBoxid({\r\n                    \"fileBagId\":this.boxKey[\"fguid\"],\r\n                    \"fileBagName\":this.boxKey[\"slotMc\"]===null || this.boxKey[\"slotMc\"]===\"\"?(this.positionArr[0]+1)+\"层-\"+(this.positionArr[1]+1)+\"节-\"+(this.positionArr[2]+1)+\"卡位\":this.boxKey[\"slotMc\"],\r\n                    \"repositoryId\":this.boxKey[\"repositoryId\"]\r\n                });\r\n                this.$forceUpdate();\r\n            } \r\n            }\r\n            debugger\r\n            if(this.$route.name ===\"GroupingQuery\" && this.boxKey[\"dataId\"]&&this.boxKey[\"dataId\"]!==null && this.boxKey[\"dataId\"]!==\"\"){\r\n                window.parent.parent.openReactForm(\r\n                        {\r\n                            id: this.boxKey.dataId,\r\n                            caption: '档案装盒',\r\n                            serverID: 'serverID', // 不需要可不传\r\n                            config: {\r\n                                displayType: 'OpenTab', // 打开方式，默认为 OpenTab:应用新tab页; DrawerForm: 抽屉； BrowserTab：浏览器tab页； OpenWindow：弹窗\r\n                                forms: 'EA_BOXING',\r\n                                OBJ_GUID:this.boxKey.dataId,\r\n                                OBJ_DJZT:\"2\"\r\n                            }\r\n                        }\r\n                    )\r\n            }\r\n        },\r\n        boxMouseOver(){\r\n            this.isHoverShow = true;\r\n            if(this.boxKey[\"dataId\"]!==\"\"&&this.boxKey[\"dataId\"]!==null && (this.voucherCode===\"\" || this.voucherCode === null)){\r\n                axios.post(`/OSPApplication/cabinet/loadBoxCode/${this.boxKey[\"dataId\"]}`).then(res=>{\r\n                if(res.data.code===\"0\"){\r\n                    this.voucherCode = res.data.data;\r\n                }\r\n            },error=>{\r\n\r\n            })\r\n            }\r\n            document.onmousemove=event=>{\r\n                var offset = $(\".CabinetTree\").offset();\r\n                var width = $(\".hover-text\").width()\r\n                var x=event.clientX  + this.scrollY -  offset.left -width-15;\r\n\t\t\t    var y=event.clientY  +this.scrollX - offset.top +10;\r\n\t\t\t\tthis.styleTopLeft[\"left\"] = x+\"px\";\r\n                this.styleTopLeft[\"top\"] = y+\"px\";\r\n            }\r\n        },\r\n        boxMouseOut(){\r\n            this.isHoverShow = false;\r\n            document.onmousemove=()=>{\r\n                return null;\r\n            }\r\n        },\r\n        handleScroll() {\r\n        this.$nextTick(()=>{\r\n                var top = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset;\r\n                var left = document.body.scrollLeft || document.documentElement.scrollLeft ||window.pageXOffset;\r\n                this.scrollX = top;\r\n                this.scrollY = left;\r\n            })\r\n        },  \r\n    },\r\n    mounted() {//可以在这里面直接进行滚动条的获取\r\n\twindow.addEventListener('scroll', this.handleScroll, true);\r\n    },\r\n    beforeDestroy(){\r\n        window.removeEventListener('scroll',this.handleScroll,true);\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"css\" scoped>\r\n.boxing {\r\n    width: 18px;\r\n    height: 50px;\r\n    border: 1px solid #999999;\r\n    margin-left: 10px;\r\n    margin-top: 0px;\r\n    cursor: pointer;\r\n}\r\n.boxOut{\r\n    display: inline-block;\r\n}\r\n.lighted{\r\n    background-color: rgb(127, 208, 255);\r\n}\r\n.isChange{\r\n    background-color: rgb(180, 241, 10)!important;\r\n}\r\n.outBox{\r\n    background-color: rgb(6, 105, 161)!important;\r\n}\r\n.hover-text {\r\n  position: absolute;\r\n  padding: 8px;\r\n  background-color: white;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}